minispade.register('ember-autosuggest/~tests/customisations_tests', "(function() {minispade.require('ember-autosuggest/~tests/test_helper');\n\nvar get = Ember.get,\n    set = Ember.set,\n    precompileTemplate = Ember.Handlebars.compile;\n\nvar App, find, click, fillIn, visit;\n\nvar indexController, controller, component, source;\n\nmodule(\"Customisations\", {\n  setup: function(){\n    Ember.$('<style>#ember-testing-container { position: absolute; background: white; bottom: 0; right: 0; width: 640px; height: 384px; overflow: auto; z-index: 9999; border: 1px solid #ccc; } #ember-testing { zoom: 50%; }</style>').appendTo('head');\n    Ember.$('<style>.hdn{ display: none; }ul.suggestions{ border: 1px solid red; }</style>').appendTo('head');\n    Ember.$('<div id=\"ember-testing-container\"><div id=\"ember-testing\"></div></div>').appendTo('body');\n\n    indexController = Ember.ArrayController.extend({\n      init: function(){\n        this._super.apply(this, arguments);\n        set(this, 'content',  Ember.A([\n          Ember.Object.create({id: 1, name: \"Bob Hoskins\"}),\n          Ember.Object.create({id: 2, name: \"Michael Collins\"}),\n          Ember.Object.create({id: 3, name: \"Paul Cowan\"}),\n        ]));\n\n        set(this, 'tags', Ember.ArrayProxy.create({content: Ember.A()}));\n      }\n    });\n\n    Ember.run(function() {\n      window.App = App = Ember.Application.create({\n        rootElement: '#ember-testing'\n      });\n\n      App.Store = DS.Store.extend({\n        revision: 13,\n        adapter: DS.FixtureAdapter.extend({\n          simulateRemoteResponse: true,\n          latency: 200\n        })\n      });\n\n      Ember.TEMPLATES.application = precompileTemplate(\n        \"{{outlet}}\"\n      );\n\n      Ember.TEMPLATES.index = precompileTemplate(\n        \"<div id='ember-testing-container'>\" +\n        \"  <div id='ember-testing'>\" +\n        \"    {{#auto-suggest source=content destination=tags minChars=0}}\" +\n        \"      <strong>CHANGED</strong>\" +\n        \"    {{/auto-suggest}}\" +\n        \"  </div>\" +\n        \"</div>\"\n      );\n\n      App.AutoSuggestComponent = window.AutoSuggestComponent;\n      App.IndexController = indexController;\n\n      App.Router.map(function() {\n        this.route('index', {path: '/'});\n      });\n\n      App.setupForTesting();\n    });\n\n    Ember.run(function(){\n      App.advanceReadiness();\n    });\n\n    App.injectTestHelpers();\n\n    find = window.find;\n    click = window.click;\n    fillIn = window.fillIn;\n    visit = window.visit;\n\n    // FIXME: Is there a cleaner way of getting the instances \n    controller = App.__container__.lookup('controller:index');\n    component = App.__container__.lookup('component:autoSuggest');\n  },\n  teardown: function(){\n    Ember.TEMPLATES = {};\n    Ember.run(function(){\n      get(controller, 'tags').clear();\n    });\n    App.removeTestHelpers();\n    Ember.$('#ember-testing-container, #ember-testing').remove();\n    Ember.run(App, App.destroy);\n    App = null;\n  }\n});\n\ntest(\"Can prepend a customisation in each suggestion\", function(){\n  equal(get(controller, 'content.length'), 3, \"precon - 3 possible selections exist\");\n\n  visit('/').then(function(){\n    equal(Ember.$('ul.suggestions').is(':visible'), false, \"precon - results ul is initially not displayed\");\n  })\n  .fillIn('input.autosuggest', 'Paul').then(function(){\n    var el = find('.results .suggestions li.result span');\n    equal(el.length, 1, \"1 search result exists\");\n    equal(el.text().normalize(), \"CHANGED Paul Cowan\", \"Text prepended to suggestions.\");\n  });\n});\n\ntest(\"Can prepend a customisation to each chosen selection\", function(){\n  equal(get(controller, 'content.length'), 3, \"precon - 3 possible selections exist\");\n\n  visit('/').then(function(){\n    equal(Ember.$('ul.suggestions').is(':visible'), false, \"precon - results ul is initially not displayed\");\n  })\n  .fillIn('input.autosuggest', 'Paul')\n  .click('.results .suggestions li.result').then(function(){\n    var el = find('.selections li.selection');\n    equal(el.length, 1, \"1 selection element has been added\");\n    ok(/CHANGED Paul Cowan/.test(el.text().normalize()), \"Text prepended to selections.\");\n  });\n});\n\n})();\n//@ sourceURL=ember-autosuggest/~tests/customisations_tests");